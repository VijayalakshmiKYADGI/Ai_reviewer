
    <!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <title>Documentation</title>
        <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
        <script>
            mermaid.initialize({ startOnLoad: true, theme: 'default' });
        </script>
        <style>
            body { font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif; line-height: 1.6; padding: 40px; max-width: 900px; margin: 0 auto; }
            h1, h2, h3 { border-bottom: 1px solid #eaecef; padding-bottom: 0.3em; }
            code { background-color: #f6f8fa; padding: 0.2em 0.4em; border-radius: 3px; font-family: monospace; }
            pre { background-color: #f6f8fa; padding: 16px; overflow: auto; border-radius: 6px; }
            table { border-collapse: collapse; width: 100%; margin: 15px 0; }
            th, td { border: 1px solid #dfe2e5; padding: 6px 13px; }
            th { background-color: #f2f2f2; }
            tr:nth-child(2n) { background-color: #f8f8f8; }
            blockquote { border-left: 4px solid #dfe2e5; color: #6a737d; padding-left: 15px; }
            .mermaid { margin: 30px 0; text-align: center; }
        </style>
    </head>
    <body>
        <h1 id="github-client-creation-environment-variables-explained">GitHub Client Creation &amp; Environment Variables Explained</h1>

<p>This document explains how the GitHub client is created and how each environment variable in your <code>.env</code> file is used throughout the AI Reviewer project.</p>

<hr />

<h2 id="overview-of-environment-variables">üìã Overview of Environment Variables</h2>

<p>Your <a href="file:///c:/Users/vijju/Desktop/V-project/Ai_reviewer/.env">.env</a> file contains several categories of variables:</p>

<table>
<thead>
<tr>
  <th>Category</th>
  <th>Variables</th>
  <th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>AI/LLM</strong></td>
  <td><code>GEMINI_API_KEY</code>, <code>GEMINI_MODEL</code></td>
  <td>Powers the AI code review agents</td>
</tr>
<tr>
  <td><strong>GitHub Auth (Token)</strong></td>
  <td><code>GITHUB_TOKEN</code></td>
  <td>Personal Access Token for reading/writing to GitHub</td>
</tr>
<tr>
  <td><strong>GitHub Auth (App)</strong></td>
  <td><code>GITHUB_APP_ID</code>, <code>GITHUB_PRIVATE_KEY_PATH</code>, <code>GITHUB_WEBHOOK_SECRET</code>, <code>INSTALLATION_ID</code></td>
  <td>GitHub App authentication (more secure, production-ready)</td>
</tr>
<tr>
  <td><strong>Database</strong></td>
  <td><code>DATABASE_URL</code></td>
  <td>Stores review history</td>
</tr>
<tr>
  <td><strong>Server</strong></td>
  <td><code>FASTAPI_HOST</code>, <code>FASTAPI_PORT</code>, <code>REDIS_URL</code></td>
  <td>Web server configuration</td>
</tr>
<tr>
  <td><strong>Configuration</strong></td>
  <td><code>REVIEW_MODE</code></td>
  <td>Controls review behavior</td>
</tr>
</tbody>
</table>

<hr />

<h2 id="github-client-creation-flow">üîë GitHub Client Creation Flow</h2>

<h3 id="entry-point-run_localpy">Entry Point: <code>run_local.py</code></h3>

<p>When you run <code>python run_local.py "VijayalakshmiKYADGI/test" 1</code>, here's what happens:</p>

<div class="mermaid">
graph TD
    A[run_local.py] -->|1. Load .env| B[load_dotenv]
    B -->|2. Check required vars| C{GITHUB_TOKEN & GEMINI_API_KEY exist?}
    C -->|No| D[‚ùå Error: Missing credentials]
    C -->|Yes| E[Create GitHubClient]
    E --> F[Create PRFetcher]
    E --> G[Create GitHubCommenter]
    F -->|Fetch PR data| H[GitHub API]
    G -->|Post review| H
</div>

<h4 id="code-location-run_localpy24-26filecusersvijjudesktopv-projectai_reviewerrun_localpyl24-l26">Code Location: <a href="file:///c:/Users/vijju/Desktop/V-project/Ai_reviewer/run_local.py#L24-L26">run_local.py:24-26</a></h4>

<pre><code>if not os.getenv("GITHUB_TOKEN") or not os.getenv("GEMINI_API_KEY"):
    print("‚ùå ERROR: Missing GITHUB_TOKEN or GEMINI_API_KEY in .env file.")
    return
</code></pre>

<h4 id="code-location-run_localpy31-33filecusersvijjudesktopv-projectai_reviewerrun_localpyl31-l33">Code Location: <a href="file:///c:/Users/vijju/Desktop/V-project/Ai_reviewer/run_local.py#L31-L33">run_local.py:31-33</a></h4>

<pre><code>client = GitHubClient()
fetcher = PRFetcher(client)
commenter = GitHubCommenter(client)
</code></pre>

<hr />

<h2 id="githubclient-architecture">üèóÔ∏è GitHubClient Architecture</h2>

<p>The <code>GitHubClient</code> class supports <strong>two authentication modes</strong>:</p>

<h3 id="mode-1-personal-access-token-pat-what-youre-using-now">Mode 1: Personal Access Token (PAT) - <strong>What you're using now</strong></h3>

<h4 id="code-location-github_integrationclientpy46-66filecusersvijjudesktopv-projectai_reviewergithub_integrationclientpyl46-l66">Code Location: <a href="file:///c:/Users/vijju/Desktop/V-project/Ai_reviewer/github_integration/client.py#L46-L66">github_integration/client.py:46-66</a></h4>

<pre><code>if auth_mode == "token":
    # Read GITHUB_TOKEN from environment
    self.token = token or os.getenv("GITHUB_TOKEN")

    if not self.token:
        raise ValueError("GitHub token not found...")

    # Initialize PyGithub client with token
    self.github = Github(self.token)

    # Create HTTP client for REST API calls
    self.http_client = httpx.AsyncClient(
        headers={
            "Authorization": f"token {self.token}",
            "Accept": "application/vnd.github.v3+json"
        }
    )
</code></pre>

<p><strong>What happens:</strong></p>

<ol>
<li>Reads <code>GITHUB_TOKEN</code> from <code>.env</code> file</li>
<li>Creates a PyGithub client (for high-level operations like <code>get_repo()</code>, <code>get_pr()</code>)</li>
<li>Creates an async HTTP client (for low-level REST API calls like posting reviews)</li>
</ol>

<h3 id="mode-2-github-app-advancedproduction-mode">Mode 2: GitHub App - <strong>Advanced/Production mode</strong></h3>

<h4 id="code-location-github_integrationclientpy69-98filecusersvijjudesktopv-projectai_reviewergithub_integrationclientpyl69-l98">Code Location: <a href="file:///c:/Users/vijju/Desktop/V-project/Ai_reviewer/github_integration/client.py#L69-L98">github_integration/client.py:69-98</a></h4>

<pre><code>elif auth_mode == "app":
    from .app_auth import GitHubAppAuth
    from config.app_config import GitHubAppConfig

    # Load GitHub App configuration
    config = GitHubAppConfig.from_env()  # Reads GITHUB_APP_ID, etc.

    # Initialize App authentication
    self.app_auth = GitHubAppAuth(
        app_id=config.app_id,
        private_key_path=config.private_key_path
    )
</code></pre>

<p><strong>What happens:</strong></p>

<ol>
<li>Reads <code>GITHUB_APP_ID</code>, <code>GITHUB_PRIVATE_KEY_PATH</code>, <code>GITHUB_WEBHOOK_SECRET</code> from <code>.env</code></li>
<li>Creates JWT tokens for GitHub App authentication</li>
<li>Gets installation tokens for specific repositories</li>
</ol>

<blockquote>
  <p>[!NOTE]<br />
  Your project supports both modes, but defaults to <strong>token mode</strong> for simplicity. GitHub App mode is more secure and has higher rate limits, but requires more setup.</p>
</blockquote>

<hr />

<h2 id="where-each-variable-is-used">üìç Where Each Variable is Used</h2>

<h3 id="1-github_token-personal-access-token">1. <code>GITHUB_TOKEN</code> (Personal Access Token)</h3>

<p><strong>Purpose:</strong> Authenticates API requests to GitHub for reading PRs and posting reviews.</p>

<p><strong>Used in:</strong></p>

<ul>
<li><a href="file:///c:/Users/vijju/Desktop/V-project/Ai_reviewer/github_integration/client.py#L48">github_integration/client.py:48</a> - Client initialization</li>
<li><a href="file:///c:/Users/vijju/Desktop/V-project/Ai_reviewer/run_local.py#L24">run_local.py:24</a> - Validation check</li>
</ul>

<p><strong>What it does:</strong></p>

<ul>
<li>Reads public/private repository data</li>
<li>Fetches PR diffs and metadata</li>
<li>Posts review comments</li>
<li>Approves/requests changes on PRs (if you have permissions)</li>
</ul>

<p><strong>Format:</strong> <code>ghp_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</code> (classic token) or <code>github_pat_xxxxx</code> (fine-grained token)</p>

<p><strong>Required Scopes:</strong></p>

<ul>
<li><code>repo</code> (full repository access)</li>
<li><code>pull_requests</code> (read/write PRs)</li>
</ul>

<hr />

<h3 id="2-gemini_api_key-google-ai-api-key">2. <code>GEMINI_API_KEY</code> (Google AI API Key)</h3>

<p><strong>Purpose:</strong> Powers the AI agents that analyze code and generate review comments.</p>

<p><strong>Used in:</strong></p>

<ul>
<li><a href="file:///c:/Users/vijju/Desktop/V-project/Ai_reviewer/core/crew.py#L33">core/crew.py:33</a> - CrewAI LLM initialization</li>
<li><a href="file:///c:/Users/vijju/Desktop/V-project/Ai_reviewer/agents/security_agent.py#L15">agents/security_agent.py:15</a> - Security analysis</li>
<li><a href="file:///c:/Users/vijju/Desktop/V-project/Ai_reviewer/agents/code_quality_agent.py#L15">agents/code<em>quality</em>agent.py:15</a> - Code quality checks</li>
<li><a href="file:///c:/Users/vijju/Desktop/V-project/Ai_reviewer/agents/performance_agent.py#L15">agents/performance_agent.py:15</a> - Performance analysis</li>
<li><a href="file:///c:/Users/vijju/Desktop/V-project/Ai_reviewer/agents/architecture_agent.py#L15">agents/architecture_agent.py:15</a> - Architecture review</li>
<li><a href="file:///c:/Users/vijju/Desktop/V-project/Ai_reviewer/agents/comprehensive_agent.py#L15">agents/comprehensive_agent.py:15</a> - Comprehensive review</li>
<li><a href="file:///c:/Users/vijju/Desktop/V-project/Ai_reviewer/agents/report_aggregator_agent.py#L13">agents/report<em>aggregator</em>agent.py:13</a> - Report aggregation</li>
</ul>

<p><strong>Example usage in agents:</strong></p>

<pre><code>llm = ChatGoogleGenerativeAI(
    model="gemini-2.5-flash-lite",
    google_api_key=os.getenv("GEMINI_API_KEY"),
    temperature=0.1
)
</code></pre>

<hr />

<h3 id="3-gemini_model">3. <code>GEMINI_MODEL</code></h3>

<p><strong>Purpose:</strong> Specifies which Gemini model to use for AI analysis.</p>

<p><strong>Current value:</strong> <code>gemini-2.5-flash-lite</code></p>

<p><strong>Options:</strong></p>

<ul>
<li><code>gemini-2.5-flash-lite</code> - Fastest, cheapest (what you're using)</li>
<li><code>gemini-1.5-flash</code> - Balanced speed/quality</li>
<li><code>gemini-1.5-pro</code> - Highest quality, slower</li>
</ul>

<hr />

<h3 id="4-review_mode">4. <code>REVIEW_MODE</code></h3>

<p><strong>Purpose:</strong> Controls whether the AI reviews only changed lines or entire files.</p>

<p><strong>Current value:</strong> <code>full_file</code></p>

<p><strong>Used in:</strong> <a href="file:///c:/Users/vijju/Desktop/V-project/Ai_reviewer/config/app_config.py#L120">config/app_config.py:120</a></p>

<p><strong>Options:</strong></p>

<ul>
<li><code>changes_only</code> - Review only the lines modified in the PR (faster)</li>
<li><code>full_file</code> - Review entire files that were touched (more thorough)</li>
</ul>

<hr />

<h3 id="5-github_app_id-github_private_key_path-github_webhook_secret">5. <code>GITHUB_APP_ID</code>, <code>GITHUB_PRIVATE_KEY_PATH</code>, <code>GITHUB_WEBHOOK_SECRET</code></h3>

<p><strong>Purpose:</strong> GitHub App authentication (alternative to Personal Access Token).</p>

<p><strong>Used in:</strong> <a href="file:///c:/Users/vijju/Desktop/V-project/Ai_reviewer/config/app_config.py#L41-L55">config/app_config.py:41-55</a></p>

<p><strong>When used:</strong></p>

<ul>
<li>Only when <code>GitHubClient(auth_mode="app")</code> is explicitly set</li>
<li>For production deployments with webhooks</li>
<li>When you want higher rate limits (5000 requests/hour vs 1000 for PAT)</li>
</ul>

<p><strong>Current status:</strong> You have these configured, but the code defaults to <code>token</code> mode.</p>

<hr />

<h3 id="6-installation_id">6. <code>INSTALLATION_ID</code></h3>

<p><strong>Purpose:</strong> Links your GitHub App to specific repositories/organizations.</p>

<p><strong>Current value:</strong> <code>104539256</code></p>

<p><strong>Used in:</strong> <a href="file:///c:/Users/vijju/Desktop/V-project/Ai_reviewer/config/app_config.py#L58-L68">config/app_config.py:58-68</a></p>

<p><strong>What it represents:</strong> The installation ID when you installed your GitHub App on your account/organization.</p>

<hr />

<h3 id="7-database_url-redis_url-fastapi_host-fastapi_port">7. <code>DATABASE_URL</code>, <code>REDIS_URL</code>, <code>FASTAPI_HOST</code>, <code>FASTAPI_PORT</code></h3>

<p><strong>Purpose:</strong> Backend infrastructure for the web server mode.</p>

<p><strong>Used when:</strong> Running the FastAPI web server (<code>api/main.py</code>) instead of <code>run_local.py</code>.</p>

<p><strong>Not used in local script mode</strong> - Only relevant for production deployments.</p>

<hr />

<h2 id="complete-authentication-flow-diagram">üîÑ Complete Authentication Flow Diagram</h2>

<div class="mermaid">
sequenceDiagram
    participant User
    participant run_local.py
    participant GitHubClient
    participant GitHub API
    participant Gemini AI

    User->>run_local.py: python run_local.py "owner/repo" 1
    run_local.py->>run_local.py: load_dotenv() - Read .env file
    run_local.py->>run_local.py: Check GITHUB_TOKEN exists
    run_local.py->>run_local.py: Check GEMINI_API_KEY exists

    run_local.py->>GitHubClient: Create client (auth_mode="token")
    GitHubClient->>GitHubClient: Read GITHUB_TOKEN from env
    GitHubClient->>GitHubClient: Initialize PyGithub with token
    GitHubClient->>GitHubClient: Create HTTP client with token

    run_local.py->>GitHubClient: Fetch PR data
    GitHubClient->>GitHub API: GET /repos/owner/repo/pulls/1
    GitHub API-->>GitHubClient: PR metadata + diff

    run_local.py->>Gemini AI: Analyze code (using GEMINI_API_KEY)
    Gemini AI-->>run_local.py: Review findings

    run_local.py->>User: Display results
    User->>run_local.py: Post to GitHub? (y/n)

    alt User says yes
        run_local.py->>GitHubClient: Post review
        GitHubClient->>GitHub API: POST /repos/owner/repo/pulls/1/reviews
        GitHub API-->>User: Review posted ‚úÖ
    else User says no
        run_local.py->>User: Review not posted üö´
    end
</div>

<hr />

<h2 id="quick-reference-variable-usage-summary">üéØ Quick Reference: Variable Usage Summary</h2>

<table>
<thead>
<tr>
  <th>Variable</th>
  <th>Required?</th>
  <th>Used By</th>
  <th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
  <td><code>GITHUB_TOKEN</code></td>
  <td>‚úÖ Yes</td>
  <td><code>GitHubClient</code>, <code>run_local.py</code></td>
  <td>Read/write GitHub PRs</td>
</tr>
<tr>
  <td><code>GEMINI_API_KEY</code></td>
  <td>‚úÖ Yes</td>
  <td>All AI agents, <code>core/crew.py</code></td>
  <td>Power AI analysis</td>
</tr>
<tr>
  <td><code>GEMINI_MODEL</code></td>
  <td>‚ö†Ô∏è Optional</td>
  <td>AI agents</td>
  <td>Choose AI model (defaults to flash)</td>
</tr>
<tr>
  <td><code>REVIEW_MODE</code></td>
  <td>‚ö†Ô∏è Optional</td>
  <td>Review pipeline</td>
  <td>Control review scope</td>
</tr>
<tr>
  <td><code>GITHUB_APP_ID</code></td>
  <td>‚ùå No*</td>
  <td><code>GitHubAppAuth</code> (app mode only)</td>
  <td>GitHub App authentication</td>
</tr>
<tr>
  <td><code>GITHUB_PRIVATE_KEY_PATH</code></td>
  <td>‚ùå No*</td>
  <td><code>GitHubAppAuth</code> (app mode only)</td>
  <td>GitHub App private key</td>
</tr>
<tr>
  <td><code>GITHUB_WEBHOOK_SECRET</code></td>
  <td>‚ùå No*</td>
  <td>Webhook handler</td>
  <td>Verify webhook signatures</td>
</tr>
<tr>
  <td><code>INSTALLATION_ID</code></td>
  <td>‚ùå No*</td>
  <td><code>InstallationManager</code></td>
  <td>GitHub App installation</td>
</tr>
<tr>
  <td><code>DATABASE_URL</code></td>
  <td>‚ùå No**</td>
  <td>FastAPI server</td>
  <td>Store review history</td>
</tr>
<tr>
  <td><code>REDIS_URL</code></td>
  <td>‚ùå No**</td>
  <td>Celery tasks</td>
  <td>Background job queue</td>
</tr>
<tr>
  <td><code>FASTAPI_HOST</code></td>
  <td>‚ùå No**</td>
  <td>FastAPI server</td>
  <td>Web server host</td>
</tr>
<tr>
  <td><code>FASTAPI_PORT</code></td>
  <td>‚ùå No**</td>
  <td>FastAPI server</td>
  <td>Web server port</td>
</tr>
</tbody>
</table>

<p>* Only required if using GitHub App mode (<code>auth_mode="app"</code>)<br />
** Only required if running web server mode (not <code>run_local.py</code>)</p>

<hr />

<h2 id="key-takeaways">üí° Key Takeaways</h2>

<ol>
<li><p><strong>For local script usage</strong> (<code>run_local.py</code>), you only need:</p>

<ul>
<li><code>GITHUB_TOKEN</code> - To access GitHub</li>
<li><code>GEMINI_API_KEY</code> - To run AI analysis</li>
</ul></li>
<li><p><strong>GitHubClient is created</strong> in <a href="file:///c:/Users/vijju/Desktop/V-project/Ai_reviewer/run_local.py#L31">run_local.py:31</a> and defaults to <strong>token mode</strong>.</p></li>
<li><p><strong>Token mode</strong> reads <code>GITHUB_TOKEN</code> from <code>.env</code> and uses it for all GitHub API calls.</p></li>
<li><p><strong>App mode</strong> is more advanced and uses <code>GITHUB_APP_ID</code> + private key for production deployments.</p></li>
<li><p><strong>Your current setup</strong> uses token mode, which works perfectly for analyzing any public repository.</p></li>
</ol>

    </body>
    </html>
    